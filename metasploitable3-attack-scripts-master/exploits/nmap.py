#######################################################
# nmap
#
# Not really an exploit but a method of enumeration.
#######################################################

from utils import Exploit
import subprocess

class Nmap(Exploit):
    def __init__(self, server_ip: str):
        super().__init__(
            os='all',
            name='Run nmap',
            description='',
            requirements=[],
            webserver=False,
            server_ip=server_ip
        )
    
    def attack(self, target: str):
        result = subprocess.run(
            ['nmap', target],
            capture_output=True,
            text=True
        )
        
        self.message(target, 'Nmap output:')
        self.message('', result.stdout)
